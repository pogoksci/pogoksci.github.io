<div class="layout-container" style="height: 100vh; display: flex; flex-direction: column; overflow: hidden;">
    <!-- SheetJS for Excel Import -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>

    <div class="layout-header" style="flex: none;">
        <div class="header-left">
            <h2>과학과 시간표 설정</h2>
        </div>
        <div class="header-right" style="margin-top: 10px;">
            <!-- Controls: Semester & Teacher Selection -->
            <select id="timetable-semester-select" class="header-select">
                <option value="">학년도 선택</option>
            </select>
            <select id="timetable-teacher-select" class="header-select">
                <option value="">교사 선택</option>
            </select>
        </div>
    </div>

    <div class="layout-content" style="flex: 1; overflow-y: auto; padding: 0 16px 76px 16px;">
        <!-- Timetable Grid -->
        <div class="timetable-container">
            <table class="timetable-grid" id="timetable-grid">
                <thead>
                    <tr>
                        <th class="period-col" style="width: 80px;">교시</th>
                        <th>월</th>
                        <th>화</th>
                        <th>수</th>
                        <th>목</th>
                        <th>금</th>
                        <th>토</th>
                        <th>일</th>
                    </tr>
                </thead>
                <tbody id="timetable-body">
                    <!-- Javascript will populate rows -->
                </tbody>
            </table>
        </div>

        <!-- Bottom Actions: Save/Cancel -->
        <div class="form-bottom-buttons"
            style="margin-top: 20px; text-align: right; display: flex; justify-content: flex-end; gap: 10px;">
            <button id="btn-cancel-timetable" class="btn-cancel">취소</button>
            <button id="btn-save-timetable" class="btn-primary">시간표 저장</button>
        </div>

        <!-- Divider & Extra Actions -->
        <div style="margin-top: 20px; border-top: 1px solid #ddd; padding-top: 20px;">
            <div style="display: flex; gap: 10px;">
                <input type="file" id="file-upload-excel" accept=".xlsx, .xls" style="display: none;" />
                <button id="btn-import-excel" class="btn-secondary" style="flex: 1; height: 40px; font-size: 14px; display: flex; align-items: center; justify-content: center; gap: 5px;">
                    <span class="material-symbols-outlined" style="font-size: 18px;">upload_file</span>
                    엑셀 업로드
                </button>
                <button id="btn-view-all" class="btn-secondary" style="flex: 1; height: 40px; font-size: 14px; display: flex; align-items: center; justify-content: center; gap: 5px;">
                    <span class="material-symbols-outlined" style="font-size: 18px;">grid_view</span>
                    전체 보기
                </button>
            </div>
            <p style="text-align: center; font-size: 10px; color: #888; margin-top: 10px;">
                * 컴시간 알리미에서 다운받은 엑셀 파일(.xlsx)을 업로드하여 시간표를 일괄 등록할 수 있습니다. (단, 과학실 설정에서 입력한 교사과 xlsx파일의 교사명이 알차해야 합니다.)
            </p>
        </div>
    </div>
    </div>
</div>