<div id="lab-usage-view-page" class="layout-container">
    <div class="layout-header">
        <div class="header-top-row">
            <div style="display: flex; align-items: center; gap: 12px;">
                <h2 style="margin: 0; font-size: 22px;">과학실 사용기록 조회</h2>
            </div>
        </div>

        <!-- Advanced Filter Bar -->
        <div class="filter-bar-card">
            <!-- Row 1: Date Period -->
            <div class="filter-row" style="margin-bottom: 15px;">
                <div class="filter-group" style="flex: 0 0 auto; min-width: 300px;">
                    <label>조회 기간</label>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <input type="date" id="filter-start-date" class="form-control" style="width: 140px;">
                        <span>~</span>
                        <input type="date" id="filter-end-date" class="form-control" style="width: 140px;">
                    </div>
                </div>
            </div>

            <!-- Row 2: Dropdowns + Search Button -->
            <div class="filter-row" style="align-items: flex-end;">
                <div class="filter-group" style="flex: 1; min-width: 120px;">
                    <label>과학실</label>
                    <select id="filter-room" class="form-select">
                        <option value="">전체 과학실</option>
                    </select>
                </div>
                <div class="filter-group" style="width: 90px;">
                    <label>학년</label>
                    <select id="filter-grade" class="form-select">
                        <option value="">전체</option>
                        <option value="1">1학년</option>
                        <option value="2">2학년</option>
                        <option value="3">3학년</option>
                    </select>
                </div>
                <div class="filter-group" style="flex: 1; min-width: 120px;">
                    <label>과목</label>
                    <select id="filter-subject" class="form-select">
                        <option value="">전체 과목</option>
                    </select>
                </div>
                <div class="filter-group" style="flex: 1; min-width: 120px;">
                    <label>교사</label>
                    <select id="filter-teacher" class="form-select">
                        <option value="">전체 교사</option>
                    </select>
                </div>
                <div class="filter-group" style="width: 100px; gap: 0 !important;">
                    <button id="btn-apply-filters" class="btn-primary"
                        style="padding: 0 15px; height: 38px; width: 100%; font-weight: 600; background-color: #00A0B2; border: none; border-radius: 8px; color: #fff; box-shadow: 0 2px 4px rgba(0, 160, 178, 0.2);">
                        조회하기
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="layout-content">
        <div class="table-container-card">
            <div class="table-status-bar" style="display: flex; justify-content: space-between; align-items: center;">
                <span id="result-count">조회 결과: 0건</span>
                <div style="display: flex; align-items: center; gap: 15px;">
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <label style="font-size: 12px; color: #888;">표시 개수:</label>
                        <select id="filter-page-size" class="form-select"
                            style="height: 32px; font-size: 13px; width: 85px; padding: 0 5px; border-radius: 4px;">
                            <option value="10">10개</option>
                            <option value="30">30개</option>
                            <option value="50">50개</option>
                            <option value="all">전체</option>
                        </select>
                    </div>

                    <button id="btn-toggle-sort" class="btn-icon-only" title="정렬 변경 (최신순/과거순)" style="padding: 0; border: 1px solid #ddd; border-radius: 6px; background: #fff; cursor: pointer; height: 32px; width: 32px; display: flex; align-items: center; justify-content: center;">
                        <span class="material-symbols-outlined" style="font-size: 20px; color: #555;">sort</span>
                    </button>

                    <button id="btn-export-excel" class="btn-primary"
                        style="height: 32px; padding: 0 16px; font-size: 13px; gap: 6px; border-radius: 8px; background-color: #00A0B2; border: none; display: flex; align-items: center; justify-content: center; color: #fff; box-shadow: 0 2px 4px rgba(0, 160, 178, 0.2);">
                        <span class="material-symbols-outlined" style="font-size: 18px;">download</span>
                        Excel 저장
                    </button>
                    <button id="btn-print-report" class="btn-secondary"
                        style="height: 32px; padding: 0 16px; font-size: 13px; gap: 6px; border-radius: 8px; background-color: #fff; border: 1px solid #777; display: flex; align-items: center; justify-content: center; color: #333; cursor: pointer;">
                        <span class="material-symbols-outlined" style="font-size: 18px;">print</span>
                        인쇄
                    </button>
                </div>
            </div>
            <div class="table-overlay-scroll">
                <table class="modern-table">
                    <thead>
                        <tr>
                            <th style="width: 100px;">날짜</th>
                            <th style="width: 65px;">교시</th>
                            <th style="width: 130px;">과학실</th>
                            <th style="width: 90px;">학급</th>
                            <th style="width: 140px;">과목</th>
                            <th style="width: 100px;">담당교사</th>
                            <th style="min-width: 250px;">활동 내용</th>
                            <th style="width: 85px; text-align: center;">안전교육</th>
                        </tr>
                    </thead>
                    <tbody id="usage-view-body">
                        <!-- Data rows will be injected here -->
                    </tbody>
                </table>
            </div>

            <!-- Pagination Controls -->
            <div id="pagination-controls"
                style="padding: 15px 20px; border-top: 1px solid #edf2f4; display: flex; justify-content: center; align-items: center; gap: 10px; background: #fdfdfd;">
                <button id="btn-prev-page" class="btn-icon-only" style="border: 1px solid #ddd; border-radius: 4px;">
                    <span class="material-symbols-outlined">chevron_left</span>
                </button>
                <span id="page-info"
                    style="font-size: 13px; font-weight: 600; color: #555; min-width: 80px; text-align: center;">1 /
                    1</span>
                <button id="btn-next-page" class="btn-icon-only" style="border: 1px solid #ddd; border-radius: 4px;">
                    <span class="material-symbols-outlined">chevron_right</span>
                </button>
            </div>

            <div id="usage-view-empty" class="empty-state"
                style="display: none; height: 300px; flex-direction: column; align-items: center; justify-content: center;">
                <span class="material-symbols-outlined" style="font-size: 40px; color: #ccc;">search_off</span>
                <p style="margin-top: 10px; color: #999; font-size: 14px;">조회된 기록이 없습니다.</p>
            </div>
        </div>
    </div>
</div>

<style>
    .filter-bar-card {
        background: #fff;
        border: 1px solid #e0e0e0;
        border-radius: 12px;
        padding: 20px;
        margin-top: 15px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.03);
        overflow-x: auto;
    }

    .filter-row {
        display: flex;
        flex-wrap: nowrap;
        gap: 12px;
        align-items: flex-end;
    }

    .filter-group {
        display: flex;
        flex-direction: column;
        gap: 6px;
        flex-shrink: 0;
    }

    .filter-group label {
        font-size: 13px;
        font-weight: 600;
        color: #666;
    }

    .filter-group .form-control,
    .filter-group .form-select {
        height: 38px;
        border-radius: 6px;
        border: 1px solid #ddd;
        padding: 0 10px;
        font-size: 14px;
        outline: none;
        transition: border-color 0.2s;
    }

    .filter-group .form-control:focus,
    .filter-group .form-select:focus {
        border-color: #00A0B2;
    }

    .table-container-card {
        background: #fff;
        border: 1px solid #e0e0e0;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.04);
    }

    .table-status-bar {
        padding: 12px 20px;
        background: #f8fbfc;
        border-bottom: 1px solid #edf2f4;
        font-size: 13px;
        color: #777;
        font-weight: 500;
    }

    .table-overlay-scroll {
        max-height: calc(100vh - 350px);
        overflow-y: auto;
        padding-bottom: 0;
    }

    .modern-table {
        width: 100%;
        border-collapse: separate; /* Changed from collapse for sticky header border */
        border-spacing: 0;
        text-align: left;
    }

    .modern-table th {
        position: sticky;
        top: 0;
        background: #fff;
        padding: 14px 20px;
        font-size: 13px;
        font-weight: 600;
        color: #555;
        border-bottom: 2px solid #edf2f4; /* Restored border */
        z-index: 10;
        white-space: nowrap;
        vertical-align: middle;
    }

    .modern-table td {
        padding: 12px 20px;
        font-size: 14px;
        color: #444;
        border-bottom: 1px solid #f2f2f2;
    }

    .modern-table tbody tr:hover {
        background-color: #f9fdfd;
    }

    .modern-table tbody tr:last-child td {
        border-bottom: none;
    }

    .badge-safety {
        display: inline-block;
        padding: 2px 8px;
        border-radius: 12px;
        font-size: 11px;
        font-weight: 600;
    }

    .badge-safety.complete {
        background-color: #e6f7ed;
        color: #1a8754;
    }

    .badge-safety.pending {
        background-color: #fff4e5;
        color: #b95000;
    }

    @media (max-width: 768px) {
        .filter-row {
            flex-wrap: wrap;
            gap: 12px;
        }

        .filter-group {
            flex: 1;
            min-width: 140px;
        }

        .filter-group[style*="width: 80px"] {
            min-width: 80px;
            flex: 0;
        }

        .filter-group[style*="width: 100px"] {
            min-width: 100px;
            flex: 0;
        }
    }
</style>