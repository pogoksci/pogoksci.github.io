<!-- /pages/usage-register.html -->
<div id="usage-register-page" class="usage-page-container">

    <!-- 1. List Section -->
    <div id="usage-list-section" class="fixed-page-layout">
        <div class="inventory-sticky-top">
            <div class="list-header">
                <h2>약품 사용량 등록</h2>
            </div>

            <div class="header-actions">
                <!-- 검색창 -->
                <div class="search-container">
                    <span class="material-symbols-outlined" style="color: #888;">search</span>
                    <input type="text" id="usage-search-input" placeholder="약품 검색...">
                </div>

                <!-- 정렬 드롭다운 (ID는 SortDropdown 컴포넌트와 일치시켜야 함) -->
                <div class="custom-dropdown" id="sort-dropdown">
                    <button class="dropdown-toggle" id="sort-toggle" aria-haspopup="true" aria-expanded="false"
                        style="height: 100%;">
                        <span class="material-symbols-outlined">sort</span>
                        <span id="sort-label" data-value="category_name_kor">한글명(분류)</span>
                        <span class="material-symbols-outlined arrow">expand_more</span>
                    </button>

                    <div class="dropdown-menu" id="sort-menu" role="menu">
                        <div class="dropdown-item" data-value="category_name_kor">
                            <span class="material-symbols-outlined">category</span>
                            한글명(분류)
                        </div>
                        <div class="dropdown-item" data-value="category_name_eng">
                            <span class="material-symbols-outlined">category</span>
                            영문명(분류)
                        </div>
                        <div class="dropdown-item" data-value="name_kor">
                            <span class="material-symbols-outlined">sort_by_alpha</span>
                            한글명(전체)
                        </div>
                        <div class="dropdown-item" data-value="name_eng">
                            <span class="material-symbols-outlined">sort_by_alpha</span>
                            영문명(전체)
                        </div>
                        <div class="dropdown-item" data-value="formula">
                            <span class="material-symbols-outlined">science</span>
                            화학식
                        </div>
                        <div class="dropdown-item" data-value="storage_location">
                            <span class="material-symbols-outlined">location_on</span>
                            위치
                        </div>
                        <div class="dropdown-item" data-value="created_at_desc">
                            <span class="material-symbols-outlined">schedule</span>
                            등록순서
                        </div>
                        <div class="dropdown-item" data-value="exhausted">
                            <span class="material-symbols-outlined">block</span>
                            소모완료약품
                        </div>
                    </div>
                </div>

                <!-- 새로고침 버튼 -->
                <button id="refresh-btn" title="목록 새로고침" aria-label="새로고침" style="height: 100%;">
                    <span class="material-symbols-outlined">refresh</span>
                </button>
            </div>
        </div>

        <div id="usage-inventory-list" class="inventory-list scrollable-list-container">
            <div class="loading-spinner">목록을 불러오는 중...</div>
        </div>
    </div>

    <!-- 2. Detail Section (Hidden by default) -->
    <div id="usage-detail-section" class="inventory-detail-page" style="display: none;">

        <div class="usage-fixed-header" style="flex-shrink: 0;">
            <div class="detail-top-bar">
                <button type="button" id="btn-back-to-list" class="btn-text">
                    <span class="material-symbols-outlined">arrow_back</span>
                    다른 약품 선택
                </button>
            </div>

            <!-- Selected Item Info (Will be injected) -->
            <div id="selected-item-display"></div>
        </div>

        <div class="detail-scroll-container">
            <div class="form-container-card">
                <h3>사용량 등록</h3>

                <form id="usage-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label>날짜</label>
                            <input type="date" id="usage-date" required>
                        </div>
                        <div class="form-group">
                            <label>과목</label>
                            <select id="usage-subject" required>
                                <option value="통합과학">통합과학</option>
                                <option value="과학탐구실험">과학탐구실험</option>
                                <option value="물리학">물리학</option>
                                <option value="화학">화학</option>
                                <option value="생명과학">생명과학</option>
                                <option value="지구과학">지구과학</option>
                                <option value="동아리">동아리</option>
                                <option value="기타">기타</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>교시</label>
                            <select id="usage-period" required>
                                <option value="1교시">1교시</option>
                                <option value="2교시">2교시</option>
                                <option value="3교시">3교시</option>
                                <option value="4교시">4교시</option>
                                <option value="5교시">5교시</option>
                                <option value="6교시">6교시</option>
                                <option value="7교시">7교시</option>
                                <option value="점심시간">점심시간</option>
                                <option value="방과후">방과후</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>사용량</label>
                            <div class="amount-input-wrapper" style="padding-bottom: 6px;">
                                <input type="number" id="usage-amount" step="0.01" min="0" placeholder="0.0">
                                <span id="usage-form-unit">mL</span>
                            </div>
                            <p class="usage-note">(※금번 '사용량'을 모를 경우, 오른쪽에 있는 '사용
                                후 시약병 질량'에 입력하세요.)</p>
                        </div>
                        <div class="form-group">
                            <label>사용 후 시약병 질량</label>
                            <div class="amount-input-wrapper">
                                <input type="number" id="usage-remaining-mass" step="0.01" min="0" placeholder="0.0">
                                <span>g</span>
                            </div>
                            <p class="usage-note" id="estimated-bottle-mass" style="margin-top: 4px; margin-bottom: 0;">
                                ※시약병의 공병 예상 질량: 정보없음</p>
                        </div>
                    </div>
                    <button type="submit" class="btn-submit">
                        <span class="material-symbols-outlined">save</span>
                        등록하기
                    </button>
                </form>
            </div>

            <div class="history-container-card">
                <h3>최근 사용 기록</h3>
                <div class="table-responsive">
                    <table class="usage-table">
                        <thead>
                            <tr>
                                <th>날짜</th>
                                <th>과목</th>
                                <th>교시</th>
                                <th>사용량</th>
                                <th>수정/삭제</th>
                            </tr>
                        </thead>
                        <tbody id="usage-history-body">
                            <!-- History rows -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </div>
</div>